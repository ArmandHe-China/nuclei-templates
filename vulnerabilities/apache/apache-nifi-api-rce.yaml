id: apache_nifi_api_rce
info:
  name: Apache nifi API RCE
  author: arliya
  severity: HIGH
  description: 'Apache NiFi is an easy to use, powerful, and reliable data processing and distribution system. Apache NiFi is designed for data streaming. It supports highly configurable data routing, transformation, and system mediation logic that indicate graphs. The system has unauthorized remote command execution vulnerability.'
  tags: apache nifi,rce

stop-at-first-match: true
requests:
  - method: GET
    path:
      - "{{RootURL}}/nifi-api/process-groups/root"
      - "{{Scheme}}://{{Host}}:8443/nifi-api/process-groups/root"
      - "{{Scheme}}://{{Host}}:9090/nifi-api/process-groups/root"
      - "{{Scheme}}://{{Host}}:9191/nifi-api/process-groups/root"
    matchers-condition: and
    matchers:
      - type: word
        part: body
        condition: and
        words:
          - "revision"
          - "canRead"
          - "{{Host}}"
          - "permissions"
      - type: status
        status:
          - 200
      - type: word
        part: header
        words:
          - "application/json"

# Enhanced by arliya on 2023/02/17
